Control Domain,Security Control ,Security Control Description,ARMory ID ,ARMory BPA Rule Description ,Checkov ID,Checkov Description
Network Security ,NS-1 ,Implement security for internal traffic,Kubernetes_Must_Restrict_Network_Access,Authorized IP ranges should be defined on Kubernetes Services,"CKV_AZURE_7,
CKV_AZURE_9,
CKV_AZURE_10,
CKV_AZURE_11,
CKV_AZURE_35,
CKV_AZURE_6,
CKV_AZURE_36,","Ensure AKS cluster has Network Policy configured,
Ensure that RDP access is restricted from the internet,
Ensure that SSH access is restricted from the internet,
Ensure no SQL Databases allow ingress from 0.0.0.0/0 (ANY IP),
Ensure default network access rule for Storage Accounts is set to deny,
Ensure AKS has an API Server Authorized IP Ranges enabled,
Ensure ‘Trusted Microsoft Services’ is enabled for Storage Account access"
Network Security ,NS-2,Connect private networks together,,,,
Network Security ,NS-3,Establish private network access to Azure services,,,,
Network Security ,NS-4,Protect applications and services from external network attacks,Kubernetes_Must_Restrict_Network_Access,Authorized IP ranges should be defined on Kubernetes Services,"CKV_AZURE_6, 
CKV_AZURE_32","Ensure AKS has an API Server Authorized IP Ranges enabled,
Ensure server parameter ‘connection_throttling’ is set to ‘ON’ for PostgreSQL Database Server"
Network Security ,NS-5,Deploy intrusion detection/intrusion prevention systems (IDS/IPS),,,,
Network Security ,NS-6,Simplify network security rules,,,CKV_AZURE_36,Ensure ‘Trusted Microsoft Services’ is enabled for Storage Account access
Network Security ,NS-7,Secure Domain Name Service (DNS),,,,
Identity Management ,IM-1,Standardize Azure Active Directory as the central identity and authentication system,"ServiceFabric_Client_AAD_Auth_Only,
AppServiceApiApp_UseManagedIdentity,
AppServiceFunctionApp_UseManagedIdentity,
AppServiceWebApp_UseManagedIdentity,","Service Fabric clusters should only use Azure Active Directory for client authentication, 
Managed identity should be used in your API App,
Managed identity should be used in your Function App,
Managed identity should be used in your Web App",CKV_AZURE_13,Ensure App Service Authentication is set on Azure App Service
Identity Management ,IM-2,Manage application identities securely and automatically,"AppServiceApiApp_UseManagedIdentity,
AppServiceFunctionApp_UseManagedIdentity,
AppServiceWebApp_UseManagedIdentity,","Managed identity should be used in your API App,
Managed identity should be used in your Function App,
Managed identity should be used in your Web App",CKV_AZURE_16,Ensure that Register with Azure Active Directory is enabled on App Service
Identity Management ,IM-3,Use Azure AD single sign-on (SSO) for application access,,,,
Identity Management ,IM-4,Use strong authentication controls for all Azure Active Directory based access,,,"CKV_AZURE_13, 
CKV_AZURE_1","Ensure App Service Authentication is set on Azure App Service,
Ensure Azure Instance does not use basic authentication(Use SSH Key Instead)"
Identity Management ,IM-5,Monitor and alert on account anomalies,,,,
Identity Management ,IM-6 ,Restrict Azure resource access based on conditions,,,,
Identity Management ,IM-7,Eliminate unintended credential exposure,,,"CKV_AZURE_131,
CKV_AZURE_41","SecureString parameter should not have hardcoded default values,
Ensure that the expiration date is set on all secrets"
Identity Management ,IM-8,Secure user access to legacy applications,,,,
Privileged Access ,PA-1,Protect and limit highly privileged users,,,,
Privileged Access ,PA-2,Restrict administrative access to business-critical systems,,,,
Privileged Access ,PA-3,Review and reconcile user access regularly,,,,
Privileged Access ,PA-4,Set up emergency access in Azure AD,,,,
Privileged Access ,PA-5,Automate entitlement management,,,,
Privileged Access ,PA-6,Use privileged access workstations,,,,
Privileged Access ,PA-7,Follow just enough administration (least privilege principle),"Kubernetes_Must_Use_RBAC, Authorization_RoleDefinition_No_Custom_RBAC","Role-Based Access Control (RBAC) should be used on Kubernetes Services, 
Use built-in roles instead of custom RBAC roles","CKV_AZURE_5,
CKV_AZURE_39","Ensure RBAC is enabled on AKS clusters,
Ensure that no custom subscription owner roles are created"
Privileged Access ,PA-8,Choose approval process for Microsoft support,,,,
Data Protection,DP-1,"Discovery, classify and label sensitive data",,,,
Data Protection,DP-2,Protect sensitive data,SQL_Enable_Encryption,Transparent Data Encryption on SQL databases should be enabled,CKV_AZURE_34,Ensure that ‘Public access level’ is set to Private for blob containers
Data Protection,DP-3,Monitor for unauthorized transfer of sensitive data,,,,
Data Protection,DP-4,Encrypt sensitive information in transit,"AppServiceApiApp_HTTPS,
AppServiceFunctionApp_HTTPS,
AppServiceWebApp_HTTPS,
AppServiceApiApp_FTPS,
AppServiceFunctionApp_FTPS,
AppServiceWebApp_FTPS,
AppServiceApiApp_RequireLatestTls,
AppServiceFunctionApp_RequireLatestTls,
AppServiceWebApp_RequireLatestTls,
Cache_Redis_SSL_Only","API App Should Only Be Accessible Over HTTPS,
Function App Should Only Be Accessible Over HTTPS,
Web Application Should Only Be Accessible Over HTTPS,
FTPS only should be required in your API App,
FTPS only should be required in your Function App,
FTPS only should be required in your Web App,
Latest TLS version should be used in your API App,
Latest TLS version should be used in your Function App,
Latest TLS version should be used in your Web App,
Only secure connections to your Azure Cache for Redis should be enabled","CKV_AZURE_3,
CKV_AZURE_14,
CKV_AZURE_15,
CKV_AZURE_18,
CKV_AZURE_28,
CKV_AZURE_29","Ensure that ‘supportsHttpsTrafficOnly’ is set to ‘true’,
Ensure web app redirects all HTTP traffic to HTTPS in Azure App Service,
Ensure web app is using the latest version of TLS encryption,
Ensure that ‘HTTP Version’ is the latest if used to run the web app,
Ensure ‘Enforce SSL connection’ is set to ‘ENABLED’ for MySQL Database Server,
Ensure ‘Enforce SSL connection’ is set to ‘ENABLED’ for PostgreSQL Database Server"
Data Protection,DP-5,Encrypt sensitive data at rest,"AutomationAccounts_Variables_Encrypted,
SQL_Enable_Encryption","Automation account variables should be encrypted,
Transparent Data Encryption on SQL databases should be enabled",CKV_AZURE_2,Ensure Azure managed disk have encryption enabled
Asset Management,AM-1,Ensure security team has visibility into risks for assets,,,,
Asset Management,AM-2,Ensure security team has access to asset inventory and metadata,,,,
Asset Management,AM-3,Use only approved Azure services,,,,
Asset Management,AM-4,Ensure security of asset lifecycle management,,,,
Asset Management,AM-5,Limit users' ability to interact with Azure Resource Manager,,,,
Asset Management,AM-6,Use only approved applications in compute resources,,,,
Logging and Threat Detection ,LT-1,Enable threat detection for Azure resources,,,CKV_AZURE_25,Ensure that ‘Threat Detection types’ is set to ‘All’
Logging and Threat Detection ,LT-2,Enable threat detection for Azure identity and access management,,,CKV_AZURE_38,Ensure audit profile captures all the activities
Logging and Threat Detection ,LT-3,Enable logging for Azure network activities,,,,
Logging and Threat Detection ,LT-4,Enable logging for Azure resources,AppService_EnableDiagLogs,Diagnostic logs in App Services should be enabled,"
CKV_AZURE_33,
CKV_AZURE_4,
CKV_AZURE_23,
CKV_AZURE_30,
CKV_AZURE_31","Ensure Storage logging is enabled for Queue service for read, write and delete requests,
Ensure AKS logging to Azure Monitoring is Configured,
Ensure that ‘Auditing’ is set to ‘Enabled’ for SQL servers,
Ensure server parameter ‘log_checkpoints’ is set to ‘ON’ for PostgreSQL Database Server,
Ensure configuration ‘log_connections’ is set to ‘ON’ for PostgreSQL Database Server"
Logging and Threat Detection ,LT-5,Centralize security log management and analysis,,,,
Logging and Threat Detection ,LT-6,Configure log storage retention,SQL_Retention_Days,SQL servers with auditing to storage account destination should be configured with 90 days retention or higher,"CKV_AZURE_12,
CKV_AZURE_24,
CKV_AZURE_37","Ensure that Network Security Group Flow Log retention period is ‘greater than 90 days’,
Ensure that ‘Auditing’ Retention is ‘greater than 90 days’ for SQL servers,
Ensure that Activity Log Retention is set 365 days or greater"
Logging and Threat Detection ,LT-7,Use approved time synchronization sources,,,,
Incident Response ,IR-1,Preparation – update incident response process for Azure,,,,
Incident Response ,IR-2,Preparation – setup incident notification,,,"CKV_AZURE_20,
CKV_AZURE_21,
CKV_AZURE_22,
CKV_AZURE_26","Ensure that security contact ‘Phone number’ is set,
Ensure that ‘Send email notification for high severity alerts’ is set to ‘On’,
Ensure that ‘Send email notification for high severity alerts’ is set to ‘On’,
Ensure that ‘Send Alerts To’ is enabled for MSSQL servers"
Incident Response ,IR-3,Detection and analysis – create incidents based on high quality alerts,,,,
Incident Response ,IR-4,Detection and analysis – investigate an incident,,,,
Incident Response ,IR-5,Detection and analysis – prioritize incidents,,,,
Incident Response ,IR-6,"Containment, eradication and recovery – automate the incident handling",,,,
Posture and Vulernability Management ,PV-1,Establish secure configurations for Azure services,,,"CKV_AZURE_8
CKV_AZURE_19","Ensure Kubernetes Dashboard is disabled
Ensure that standard pricing tier is selected"
Posture and Vulernability Management ,PV-2,Sustain secure configurations for Azure services,"AppServiceApiApp_RestrictCORSAccess,
AppServiceFunctionApp_RestrictCORSAccess,
AppServiceWebApp_RestrictCORSAccess,
AppServiceApiApp_DisableRemoteDebugging,
AppServiceFunctionApp_DisableRemoteDebugging,
AppServiceWebApp_DisableRemoteDebugging","CORS should not allow every resource to access your API App,
CORS should not allow every resource to access your Function Apps,
CORS should not allow every resource to access your Web Applications,
Remote debugging should be turned off for API Apps,
Remote debugging should be turned off for Function Apps,
Remote debugging should be turned off for Web Applications",CKV_AZURE_17,Ensure the web app has ‘Client Certificates (Incoming client certificates)’ set
Posture and Vulernability Management ,PV-3,Establish secure configurations for compute resources,,,,
Posture and Vulernability Management ,PV-4,Sustain secure configurations for compute resources,,,,
Posture and Vulernability Management ,PV-5,Securely store custom operating system and container images,,,CKV_AZURE_41,Ensure that the expiration date is set on all secrets
Posture and Vulernability Management ,PV-6,Perform software vulnerability assessments,,,,
Posture and Vulernability Management ,PV-7,Rapidly and automatically remediate software vulnerabilities,,,,
Posture and Vulernability Management ,PV-8,Conduct regular attack simulation,,,,
Endpoint Security ,ES-1,Use Endpoint Detection and Response (EDR),,,,
Endpoint Security ,ES-2,Use centrally managed modern anti-malware software,,,,
Endpoint Security ,ES-3,Ensure anti-malware software and signatures are updated,,,,
Backup and Recovery,BR-1,Ensure regular automated backups,,,,
Backup and Recovery,BR-2,Encrypt backup data,,,,
Backup and Recovery,BR-3,Validate all backups including customer-managed keys,,,,
Backup and Recovery,BR-4,Mitigate risk of lost keys,,,CKV_AZURE_42,Ensure the key vault is recoverable
Governance and Strategy ,GS-1,Define asset management and data protection strategy,,,,
Governance and Strategy ,GS-2,Define enterprise segmentation strategy,,,,
Governance and Strategy ,GS-3,Define security posture management strategy,,,,
Governance and Strategy ,GS-4,"Align organization roles, responsibilities, and accountabilities",,,,
Governance and Strategy ,GS-5,Define network security strategy,,,,
Governance and Strategy ,GS-6,Define identity and privileged access strategy,,,,
Governance and Strategy ,GS-7,Define logging and threat response strategy,,,,
Governance and Strategy ,GS-8,Define backup and recovery strategy,,,,
